<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <title>会议列表</title>
	<meta http-equiv="pragma" content="no-cache">
	<meta http-equiv="cache-control" content="no-cache">
	<meta http-equiv="expires" content="0">    
	<meta http-equiv="keywords" content="keyword1,keyword2,keyword3">
	<meta http-equiv="description" content="This is my page">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<!--
	<link rel="stylesheet" type="text/css" href="styles.css">
	
	 <link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.1/jquery.mobile-1.2.1.min.css" />
	 <script src="http://code.jquery.com/jquery-1.8.3.min.js"></script>
	 <script src="http://code.jquery.com/mobile/1.2.1/jquery.mobile-1.2.1.min.js"></script>
	-->  
	 <link rel="stylesheet" href="include/jquery.mobile-1.4.2.min.css" />
	 <script src="include/jquery-1.8.3.min.js"></script>
	 <script>  
	 	var myIP = "192.168.1.104:8080";
	     //设置 必须引用在jqueryMobile 之前 
		$(document).bind("mobileinit", function()  
		{  
		   //if (navigator.userAgent.indexOf("Android") != -1)  
		   //{  
		     $.mobile.defaultPageTransition = 'none';  
		     $.mobile.defaultDialogTransition = 'none';  
		   //}  
		});     
	</script> 
	 <script src="include/jquery.mobile-1.4.2.min.js"></script>
	 <script type='text/javascript' src='http://mianyang.dd100.net:8080/meetManager/dwr/interface/cbus.js'></script>
     <script type='text/javascript' src='http://mianyang.dd100.net:8080/meetManager/dwr/engine.js'></script>
  	
  	
  	<style type="text/css">
  		.actGotop{position:fixed;_position:absolute;bottom:15;right:10px;width:50px;height:50px;}
  		.pop.out.reverse{
			 -webkit-transform:scale(.2);
			 opacity:0;
			 -webkit-animation-name:null;
			 z-index:10;
		}
  	</style>
  
  </head>
  
  <body >
 <!-- 
 
 data-rel: opens External 
 data-prefetch="true"
 data-transition = "none"
 $(this).attr("bid")
  -->      	
       	
<div data-role="page" id="index" >
  <div data-role="header" data-theme="a"  data-position="fixed" data-tap-toggle="false">
  <h1>|í、БābУ 公交查询</h1>
  <nav data-role="navbar">
    <ul>
      <li><a data-icon="home" data-transition="none" class="ui-btn-active">首页</a></li>
      <li><a id="b_sb" data-rel="dialog" data-transition="none" data-icon="search">查询</a></li>
      <li><a href="#email" data-rel="dialog" data-icon="grid" data-transition="none">邮件</a></li>
      <li><a href="#calendar" data-rel="dialog" data-icon="star" data-transition="none">日历</a></li>
    </ul>
  </nav>
  </div>
  
  <div id="home" data-role="content">
       <p style="text-align:center;color:grey;display:none;">成都市所有公交车列表</p>
       <ul id="bus_list" data-role="listview" data-autodividers="true" data-inset="true" data-filter="true" data-filter-placeholder="搜索公交路线">
		    <li><a href="#">正在加载...</a></li>
	  </ul>
	  <div class="actGotop"><a href="javascript:;" title="返回顶部">顶部</a></div>
  </div>
   
   <div data-role="footer" data-position="fixed" data-theme="a" data-tap-toggle="false">
   <h1>版权所有 |í、БābУ</h1>
  </div>
</div> 





 <script type="text/javascript">
 		 DWREngine.setMethod(DWREngine.ScriptTag);
	     cbus._path = "http://mianyang.dd100.net:8080/meetManager/dwr";
	  	 cbus.getBusList(slist);
	  	 function slist(list){
	  	 	 var len = list.length;
	  	 	 var str ="";
	  	 	 for(var i=0;i<len;i++){
	  	 	 	  var obj = list[i];
	  	 	 	  str +="<li  bname='"+obj.bname+"' bid='"+obj.bid+"'><a href='#'>"+obj.bname+"<span class='ui-li-count'>25</span></a></li>";
	  	 	 }
	  	 	 
	  	 	 //document.getElementById("bus_list").innerHTML = str;
	  	 	 $("#bus_list").html("");
	  	 	 $("#bus_list").append(str);
	  	 	 $("#bus_list").listview('refresh');
	  	 	 
	  	 	 $('ul#bus_list').find("li").each(function(){
	  	 	 		$(this).on("tap",function(){
					      $.mobile.changePage("#search_bus",'none', false, false);
					      $("#bus_name").html($(this).attr("bname"));
					      cbus.getBusStation($(this).attr("bid"),"",showR);
					});
	  	 	 		//$(this).live("tap",function(){
					     //$.mobile.changePage("#search_bus",'none', false, false);
					//});
	  	 	 });
	  	 }
	   
	     function showR(list){
	     
	     	var len = list.length;
	  	 	 var str ="";
	  	 	 for(var i=0;i<len;i++){
	  	 	 	  var obj = list[i];
	  	 	 	  str +="<li><a href='#'>"+obj.st_name+"</li>";
	  	 	 }
	  	 	 
	  	 	 //document.getElementById("bus_list").innerHTML = str;
	  	 	 $("#bus_station_z").html("");
	  	 	 $("#bus_station_z").append(str);
	  	 	 $("#bus_station_z").listview('refresh');
	  	 	 
	     }
	   
	  	 
	  	 //初始化
	  	 $(document).on("pageinit","#index",function(){
	  	 	  $.mobile.page.prototype.options.domCache=true; //页面缓存
	  	      $.mobile.transitionFallbacks.slideout = "none"; //防止闪屏
	  	        
			  $("#index").on("swipeleft",function(){
			      $.mobile.changePage("#search_bus");
			  });
		 });
		 
 </script>



<div data-role="dialog" id="search_bus">
  <div data-role="header">
  <h1 id="bus_name">188路</h1>
   <a href="#index" data-role="button" class="ui-btn-right" data-icon="back" data-rel="back" data-transition="none">返回</a>
    <div data-role="tabs">
	      <div data-role="navbar">
		    <ul>
		      <li><a href="#bus_station_z" data-ajax="true" class="ui-btn-active">上行</a></li>
		      <li><a href="#bus_station_f" data-ajax="true" >下行</a></li>
		    </ul>
		  </div>
		  <div >
		    <ul id="bus_station_z" data-role="listview" data-inset="true">
		        <li><a href="#">正在加载...</a></li>
		    </ul>
		  </div>
		   <div >
		    <ul id="bus_station_f" data-role="listview" data-inset="true">
		        <li><a href="#">正在加载...</a></li>
		    </ul>
		  </div>
    </div>
  </div>
</div> 
	
	<div data-role="page" id="xx">
		  <ul data-role="listview" data-autodividers="false" data-inset="true" data-filter="true">
		    <li><a href="#">Bill Gates</a></li>
		  </ul>
	</div>
       	
  </body>
</html>
